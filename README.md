# bacterial-variant-calling

## Project Overview
This project involves the genome assembly and variant calling of a Pneumococcal strain. The project was carried out as part of a group effort to investigate the bacteria evolution and to practice bioinformatics skills.
S. pneumoniae strain BHN97x was separated into three groups for 72hr infection in three individual experimental evolution lineages (M1 and M2) and continuously repeated for 10 generations. This part of the code is excerpted from the data processing I performed in our group assignment. Only the first group were selected for this practice. 

## Table of Contents
- [Data](#data)
- [Process Documentation](#process-documentation)
	- [Data Preprocessing](#data-preprocessing)
	- [Genome Assembly and Annotation](#genome-assembly-and-annotation)
	- [Reads Mapping](#reads-mapping)
	- [Variant Calling](#variant-calling)
- [Results](#results)
- [Usage](#usage)
- [Contributors](#contributors)
- [License](#license)

## Data
Sequence data were downloaded through NCBI via BioProject accession number PRJNA624363. Files were not uploaded here due to the large file size.

## Process Documentation
### Data Preprocessing
1. **Data Download**:
	- A list of SRA accession numbers were generated by SRA Run Selector and saved in SRR_Acc_List.txt. Run scripts/download_data.sh to download and compress the data.
2. **Quality Check**:
	- FastQC(v. 0.12.1) was used to get an overview of sequencing data quality.
3. **Data Filtering**:
	- Adapter trimming, sequence correction and filtering was conducted by Fastp (v. 0.23.2). Run scripts/download_data.sh to trim and filter the data.

### Genome Assembly and Annotation
The first input strain BHN97x (19Fx Lineage 1 Input and 19Fx Lineage 2 Input) for its corresponding lineage was assembled as a reference genome by using SPAdes genome assembler (v.3.15.4). The assembled genome was evaluated with QUAST(v. 5.0.2.). The gene prediction was constructed by using prokka (v. 1.11).
 - Rename the fastq.gz files manually for the following step according to SRR_to_FILENAME.txt. 
1. **Genome assembly**:
	- Parameter -k 21,33,55,77 is specialized for assembling 150bp reads.
```bash
$ mkdir assembly
$ spades.py -k 21,33,55,77 --careful -o data/assembly/ -1 data/sra/trimmed/anc_R1.fastq.gz -2 data/sra/trimmed/anc_R2.fastq.gz
```
2. **Assembly evaluation**:
```bash
$ mkdir assembly/quast
$ quast assembly/scaffolds.fasta -o assembly/quast
```
3. **Annotation**:
```bash
$ mkdir annotation
$ prokka --kingdom Bacteria --genus Streptococcus --species pneumococcus --outdir annotation scaffolds.fasta
```

### Reads mapping
All 10 generations were mapped to the assembled genome. The duplicates and low-quality reads were filtered by samtools (v. 1.9), which were evaluated by using QualiMap (v. 2.2.2a).
Run scripts/mapping.sh to mapping the reads.

### Variant calling
Variants calling was done with freebayes (v. 0.9.21.7.). The statistics of the variant calls were generated with BCFtools (v. 1.18). 
Run scripts/variant_calling.sh to call variants.

## Results
1. **IGV Visualization**:
	- Display the vcf files in IGV.
2. **Bar Graph**:
	- Show variant distribution among generation by running Variant_sum.R.

## Usage
### Prerequisites
Please refer to INSTALLATION.md file to install fast, bwa, samtools, qualimap, bcftools, bamtools, freebayes, tabix, rtg-tools.

### Steps to Reproduce
Provide a step-by-step guide on how to reproduce the analysis:
1. Clone the repository.
   ```bash
   git clone https://github.com/yourusername/bacterial-genome-assembly.git
   cd bacterial-genome-assembly
2. Revise the file path before running scripts.

## Contributors
### Main Contributor
- [Tang-sy](https://github.com/tang-sy) - Main contributor, responsible for the code and documentation in this repository.
### Acknowledgments
- Group Members: LAM King Kin, LAM Yuk Yan, LUO Jingjing 

## License
### Additional Notes:
- **Scripts and Automation**: Make sure your scripts (`download_data.sh`, `trim_filter_data.sh`, `mapping.sh`, and `variant_calling.sh`) are well-documented and included in your repository.
- **Results Section**: You can include links to result files or more detailed descriptions of your findings in the Results section.
- **Contributors and License**: Fill in the Contributors section with the names of people who contributed to the project and specify the license under which the project is distributed.
